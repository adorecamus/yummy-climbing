<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.yummyclimbing.mapper.user.UserInfoMapper">

	<sql id="userInfoCols">
		UI_NUM, UI_ID, UI_PWD, UI_NAME,
		UI_NICKNAME, UI_ADDR,
		UI_ZONECODE, UI_GRADE,
		UI_AGE, UI_GENDER, UI_IMG_PATH, UI_CREDAT,
		UI_ACTIVE
	</sql>


	<select id="selectUserInfo"
		resultType="com.yummyclimbing.vo.user.UserInfoVO">
		SELECT
		<include refid="userInfoCols" />
		FROM USER_INFO
		WHERE UI_NUM = #{uiNum}
	</select>

		<!-- 로그인 -->
	<select id="loginUserInfo"
		resultType="com.yummyclimbing.vo.user.UserInfoVO">
		SELECT
		<include refid="userInfoCols" />
		FROM USER_INFO
		WHERE UI_ID = #{uiId}
		AND UI_PWD = #{uiPwd}
	</select>


		<!--아이디 중복확인용 -->
	<select id="selectUserInfoById"
		resultType="com.yummyclimbing.vo.user.UserInfoVO">
		SELECT
		<include refid="userInfoCols" />
		FROM USER_INFO
		WHERE UI_ID = #{uiId}
	</select>
		<!--닉네임 중복확인 -->
	<select id="selectUserInfoByNickname"
		resultType="com.yummyclimbing.vo.user.UserInfoVO">
		SELECT
		<include refid="userInfoCols" />
		FROM USER_INFO
		WHERE UI_NICKNAME = #{uiNickname}
	</select>


	<!-- 회원가입용 sql -->
	<insert id="insertUserInfo"
		parameterType="com.yummyclimbing.vo.user.UserInfoVO">
		
		INSERT INTO USER_INFO(
		UI_ID, UI_PWD, UI_NAME, UI_NICKNAME,
		UI_ADDR, UI_ZONECODE, UI_AGE, UI_GENDER,
		UI_IMG_PATH, UI_CREDAT, UI_ACTIVE
		) VALUES(
		#{uiId}, #{uiPwd}, #{uiName}, #{uiNickname},
		#{uiAddr}, #{uiZonecode},
		#{uiAge}, #{uiGender},
		#{uiImgPath},DATE_FORMAT(NOW(),'%Y%m%d') ,1
		)
	</insert>

	<!-- 정보수정 -->
	<update id="updateUserInfo">
		UPDATE USER_INFO
		SET UI_NICKNAME=#{uiNickname},
		UI_ADDR=#{uiAddr},
		UI_ZONECODE=#{uiZonecode}
		WHERE UI_NUM=#{uiNum}
	</update>

	<!-- 회원탈퇴(비활성화) -->
	<delete id="deleteUserInfo">
		UPDATE USER_INFO
		SET UI_ACTIVE = 0
		WHERE UI_NUM=#{uiNum}
	</delete>

</mapper>