<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yummyclimbing.mapper.party.PartyBoardNoticeMapper">

	<!-- 소모임 공지사항 리스트 -->
	<select id="selectPartyNoticeList" resultType="com.yummyclimbing.vo.party.PartyBoardNoticeVO">
		SELECT PBN_CONTENT, PBN_CREDAT, PBN_LMODAT
		FROM PARTY_BOARD_NOTICE
		WHERE PBN_ACTIVE =1 AND PI_NUM = #{piNum}
	</select>
	
	<!-- 소모임 공지사항 상세정보 -->
	<select id="selectPartyNotice" resultType="com.yummyclimbing.vo.party.PartyBoardNoticeVO">
		SELECT PBN_CONTENT, PBN_CREDAT, PBN_LMODAT, PBN_CRETIM, PBN_LMOTIM
		FROM PARTY_BOARD
		WHERE PBN_NUM = #{pbnNum}
	</select>
	
	<!-- 소모임 공지사항 작성 -->
	<insert id="insertPartyNotice" parameterType="com.yummyclimbing.vo.party.PartyBoardNoticeVO">
		INSERT INTO PARTY_BOARD_NOTICE(
		PBN_CONTENT, PBN_CREDAT, PBN_LMODAT, 
		PBN_CRETIM, PBN_LMOTIM, PBN_ACTIVE, 
		PI_NUM, UI_NUM)
		VALUES(
		#{pbnContent}, DATE_FORMAT(NOW(),'%Y%m%d'), DATE_FORMAT(NOW(),'%Y%m%d'),
		DATE_FORMAT(NOW(),'%r'), DATE_FORMAT(NOW(),'%r'), 1,
		#{piNum}, #{uiNum});
	</insert>
	
	<!-- 소모임 공지사항 수정 -->
	<update id="updatePartyNotice" parameterType="com.yummyclimbing.vo.party.PartyBoardNoticeVO">
		UPDATE PARTY_BOARD
		SET
		PBN_CONTENT = #{pbnContent},
		PBN_LMODAT = DATE_FORMAT(NOW(),'%Y%m%d'),
		PBN_LMOTIM = DATE_FORMAT(NOW(),'%r')
		WHERE PBN_NUM = #{pbnNum}
	</update>
	
	<!-- 소모임 공지사항 삭제(비활성화시킴) -->
	<update id="updatePartyNoticeActive" >
		UPDATE PARTY_BOARD_NOTICE
		SET PBN_ACTIVE = 0
		WHERE PBN_NUM = #{pbnNum}
	</update>
</mapper>